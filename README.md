# –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è ML-–ø–∞–π–ø–ª–∞–π–Ω–∞ —Å Apache Airflow

## –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ–≥–æ –ø–∞–π–ø–ª–∞–π–Ω–∞ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ–ø—É—Ö–æ–ª–µ–π –º–æ–ª–æ—á–Ω–æ–π –∂–µ–ª–µ–∑—ã (–¥–æ–±—Ä–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ / –∑–ª–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ) –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **Apache Airflow** –∏ **–æ–±–ª–∞—á–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞**.

## –≠—Ç–∞–ø 1. –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–∞

### –§–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞ ML-–∑–∞–¥–∞—á–∏

–¢–∏–ø –∑–∞–¥–∞—á–∏: **–±–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è**  
–ö–ª–∞—Å—Å—ã:
- `M` ‚Äî –∑–ª–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –æ–ø—É—Ö–æ–ª—å
- `B` ‚Äî –¥–æ–±—Ä–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –æ–ø—É—Ö–æ–ª—å

–ò—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –º–æ–¥–µ–ª—å: `LogisticRegression`  
–ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞: `Accuracy`, `Precision`, `Recall`, `F1-score`

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞

```mermaid
graph TD
    A[–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö] --> B[–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö]
    B --> C[–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏]
    C --> D[–û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏]
    D --> E[–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤]
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```plaintext
project/
‚îú‚îÄ‚îÄ dags/
‚îÇ   ‚îî‚îÄ‚îÄ pipeline_dag.py         # DAG-—Ñ–∞–π–ª Airflow
‚îú‚îÄ‚îÄ etl/
‚îÇ   ‚îú‚îÄ‚îÄ load_data.py            # –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –ø–µ—Ä–≤–∏—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑
‚îÇ   ‚îú‚îÄ‚îÄ preprocess.py           # –û—á–∏—Å—Ç–∫–∞ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ train_model.py          # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ evaluate.py             # –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
‚îÇ   ‚îî‚îÄ‚îÄ save_results.py         # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
‚îú‚îÄ‚îÄ results/                    # –§–∏–Ω–∞–ª—å–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã
‚îú‚îÄ‚îÄ logs/                       # –õ–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è DAG
‚îú‚îÄ‚îÄ config.yaml                 # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–∞–π–ø–ª–∞–π–Ω–∞
‚îú‚îÄ‚îÄ .env                        # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ requirements.txt            # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ README.md                   # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
```

### –≠—Ç–∞–ø—ã –ø–∞–π–ø–ª–∞–π–Ω–∞

| –≠—Ç–∞–ø             | –°–∫—Ä–∏–ø—Ç                 | –û–ø–∏—Å–∞–Ω–∏–µ                                                       |
|------------------|------------------------|----------------------------------------------------------------|
| –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö  | `etl/load_data.py`     | –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ CSV, –±–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ          |
| –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞    | `etl/preprocess.py`    | –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö, –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è, —Ä–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ train/test          |
| –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏  | `etl/train_model.py`   | –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ `LogisticRegression` –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ              |
| –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏    | `etl/evaluate.py`      | –†–∞—Å—á—ë—Ç –º–µ—Ç—Ä–∏–∫: Accuracy, Precision, Recall, F1                 |
| –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ       | `etl/save_results.py`  | –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –∏ –º–µ—Ç—Ä–∏–∫ –ª–æ–∫–∞–ª—å–Ω–æ –∏–ª–∏ –≤ –æ–±–ª–∞–∫–æ               |


## –≠—Ç–∞–ø 2: –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ ETL-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

–í —ç—Ç–æ–º —ç—Ç–∞–ø–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –æ—Ç–¥–µ–ª—å–Ω—ã–µ Python-—Å–∫—Ä–∏–ø—Ç—ã, –≤—ã–ø–æ–ª–Ω—è—é—â–∏–µ —ç—Ç–∞–ø—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –æ–±—É—á–µ–Ω–∏—è –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤. –í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω—ã –∫–∞–∫ –≤—Ä—É—á–Ω—É—é, —Ç–∞–∫ –∏ —á–µ—Ä–µ–∑ Apache Airflow, –ø—Ä–∏–Ω–∏–º–∞—é—Ç –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏, –∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã.

### `etl/load_data.py`
–ó–∞–≥—Ä—É–∂–∞–µ—Ç –∏—Å—Ö–æ–¥–Ω—ã–π CSV-—Ñ–∞–π–ª (`wdbc.data.csv`), —É–¥–∞–ª—è–µ—Ç —Å—Ç–æ–ª–±–µ—Ü `id`, –∑–∞–¥–∞—ë—Ç –Ω–∞–∑–≤–∞–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ `results/data_loaded.csv`.

### `etl/preprocess.py`
–û—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç:
- –∫–æ–¥–∏—Ä–æ–≤–∫—É –º–µ—Ç–æ–∫ (`M` ‚Üí 1, `B` ‚Üí 0),
- –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (`StandardScaler`),
- —Ä–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ `X_train`, `X_test`, `y_train`, `y_test`.

–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ `.pkl` —Ñ–æ—Ä–º–∞—Ç–µ –≤ `results/`.

### `etl/train_model.py`
–û–±—É—á–∞–µ—Ç –º–æ–¥–µ–ª—å `LogisticRegression` –Ω–∞ `X_train` –∏ `y_train`.  
–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –º–æ–¥–µ–ª—å –≤ `results/model.pkl`.

### `etl/evaluate.py`
–í—ã—á–∏—Å–ª—è–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏:
- Accuracy
- Precision
- Recall
- F1-score

–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –≤ `results/metrics.json`.

### `etl/save_results.py`
–§–∏–Ω–∞–ª—å–Ω—ã–π —ç—Ç–∞–ø. –ö–æ–ø–∏—Ä—É–µ—Ç –∏—Ç–æ–≥–æ–≤—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã (`model.pkl`, `metrics.json`) –≤ –ø–∞–ø–∫—É `results/final/`, –º–æ–¥–µ–ª–∏—Ä—É—è "–≤—ã–≥—Ä—É–∑–∫—É –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ". –ì–æ—Ç–æ–≤–æ –¥–ª—è –∑–∞–º–µ–Ω—ã –Ω–∞ –æ–±–ª–∞—á–Ω—É—é –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

---

–í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –ø–µ—Ä–µ–¥–∞—á—É –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —á–µ—Ä–µ–∑ `argparse` –∏ –º–æ–≥—É—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –≤ Airflow –∫–∞–∫ –∑–∞–¥–∞—á–∏ `PythonOperator`.

## –≠—Ç–∞–ø 3. –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –ø–∞–π–ø–ª–∞–π–Ω–∞ —Å –ø–æ–º–æ—â—å—é Airflow (—Ñ–∞–π–ª ‚Äî –≤ `dags/`)

### –ù–∞–∑–≤–∞–Ω–∏–µ DAG
`breast_cancer_dag`

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –∑–∞–¥–∞—á–∞–º–∏

–ü–∞–π–ø–ª–∞–π–Ω –≤–∫–ª—é—á–∞–µ—Ç –¥–≤–µ –∑–∞–¥–∞—á–∏:

1. `extract_data` ‚Äî –∑–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞—Ç–∞—Å–µ—Ç Breast Cancer –∏–∑ `sklearn.datasets` –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –µ–≥–æ –≤ `dataset.csv` –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `/tmp/breast_cancer`.

2. `train_model` ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π CSV-—Ñ–∞–π–ª, –æ–±—É—á–∞–µ—Ç –º–æ–¥–µ–ª—å `RandomForestClassifier`, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –º–æ–¥–µ–ª—å –≤ `model.pkl` –∏ –º–µ—Ç—Ä–∏–∫—É —Ç–æ—á–Ω–æ—Å—Ç–∏ –≤ `metrics.txt`.

–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É –∑–∞–¥–∞—á–∞–º–∏:

```
extract_data ‚Üí train_model
```

–û–±–µ –∑–∞–¥–∞—á–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `PythonOperator`. –ü–∞–π–ø–ª–∞–π–Ω –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –∑–∞–ø—É—Å–∫ (`@daily`) –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç `catchup`.

---

### ‚ñ∂Ô∏è –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É DAG

#### –ß–µ—Ä–µ–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª:

```bash
# –ü—Ä–æ–≥–æ–Ω extract_data –Ω–∞ 17 –∏—é–Ω—è 2025
airflow tasks test breast_cancer_dag extract_data 2025-06-17

# –ü—Ä–æ–≥–æ–Ω train_model –Ω–∞ —Ç—É –∂–µ –¥–∞—Ç—É
airflow tasks test breast_cancer_dag train_model 2025-06-17
```

#### –ß–µ—Ä–µ–∑ Airflow UI:

- –û—Ç–∫—Ä–æ–π—Ç–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ –∞–¥—Ä–µ—Å—É `http://localhost:8080`
- –ù–∞–π–¥–∏—Ç–µ DAG —Å –∏–º–µ–Ω–µ–º `breast_cancer_dag`
- –í–∫–ª—é—á–∏—Ç–µ —Ç—É–º–±–ª–µ—Ä —Å–ª–µ–≤–∞ –æ—Ç –Ω–∞–∑–≤–∞–Ω–∏—è
- –ù–∞–∂–º–∏—Ç–µ **Trigger DAG** –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É

---

### üóÇ –§–∞–π–ª DAG

```
dags/breast_cancer_dag.py
```

---

### üì¶ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã)

–í—Å–µ –≤—ã—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `/tmp/breast_cancer/`:

- `dataset.csv` ‚Äî –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ;
- `model.pkl` ‚Äî –æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å;
- `metrics.txt` ‚Äî —Ç–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ (`accuracy`).

---

### üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º –º–µ—Ö–∞–Ω–∏–∑–º–æ–º Airflow (`~/airflow/logs/...`).
- –í –∫–∞—á–µ—Å—Ç–≤–µ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `SequentialExecutor` —Å SQLite (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞).